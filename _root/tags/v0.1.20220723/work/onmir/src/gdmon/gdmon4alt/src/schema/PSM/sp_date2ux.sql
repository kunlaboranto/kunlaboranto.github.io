-- ex)
-- v$session.LOGIN_TIME
-- iSQL> select ux2date('1239079710') from dual;
-- 2009/04/07 13:48:30  
-- iSQL> select date2ux(sysdate) C1, TO_CHAR( date2ux(sysdate,13) ) C2, date2ux(to_date('2009/04/07 13:48:30','YYYY/MM/DD HH24:MI:SS')) C3 from dual;
-- 1554442343 1554442343329 1239079710  

CREATE OR REPLACE FUNCTION DATE2UX
(
	A_TIMESTAMP		IN	DATE
,	A_SCALE			IN	NUMBER	DEFAULT NULL
)
RETURN NUMBER(13)
IS
	V_UNIX_TS		NUMBER(13);
BEGIN
    IF A_SCALE IS NULL THEN
        V_UNIX_TS := ( A_TIMESTAMP - TO_DATE('1970010109','YYYYMMDDHH24') ) * 60 * 60 * 24 ;
    ELSE
        V_UNIX_TS := ( A_TIMESTAMP - TO_DATE('1970010109','YYYYMMDDHH24') ) * 60 * 60 * 24 * 1000 + TO_NUMBER( TO_CHAR( A_TIMESTAMP, 'FF3' ) ) ;
    END IF;

    RETURN V_UNIX_TS;
EXCEPTION
    WHEN OTHERS THEN
		SYSTEM_.PRINTLN('['||TO_CHAR(SYSDATE,'YYYY/MM/DD HH24:MI:SS.FF6')||'] ERR-'||SQLCODE||' '||SQLERRM );
		RAISE;
        --RETURN V_UNIX_TS ;
END;
/

CREATE PUBLIC SYNONYM DATE2UX FOR SYS.DATE2UX;
GRANT EXECUTE ON DATE2UX TO US_GDMON;
